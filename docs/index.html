<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libode: libode</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libode
   </div>
   <div id="projectbrief">A variety of explicit and implicit single-step ODE integrators as C++ classes</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">libode </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>libode is a library of C++ classes for solving systems of ordinary differential equations in autonomous form. All of the solvers are single-step, Runge-Kutta-like methods. There are explicit, adaptive solvers up to the ninth order. The repository also includes Rosenbrock methods, a singly-diagonal implicit Runge-Kutta (SDIRK) method, and several fully implicit Runge-Kutta methods.</p>
<p>Several of the solvers and much more detail on the methods can be found in these amazing books:</p><ul>
<li>Hairer, E., NÃ¸rsett, S. P. &amp; Wanner, G. Solving Ordinary Differential Equations I: Nonstiff Problems. (Springer-Verlag, 1987).</li>
<li>Hairer, E. &amp; Wanner, G. Solving Ordinary Differential Equations II: Stiff and Differential-Algebraic Problems. (Springer, 1996).</li>
</ul>
<h1><a class="anchor" id="sec_compiling"></a>
Compiling</h1>
<p>First, before any of the <code>libode</code> classes can be compiled, you must copy the <code>_config.mk</code> file to <code>config.mk</code> and edit that file to specify the compiler settings you'd like the Makefile to use. This shouldn't be complicated. If you are using a current version of the GNU C++ compiler (g++), no changes to the contents of the template config file are needed. There are also commented lines for use with the Intel C++ compiler (icpc), if that is available. To compile all the classes, simply run <code>make</code> in the top directory.</p>
<p>The Makefile compiles all of the necessary code into the <code>obj</code> folder, then archives it in the <code>bin</code> directory as a file called <code>libode.a</code>. To use the solvers, you can link <code>libode.a</code> (in the <code>bin</code> directory) or the object files directly (in the <code>obj</code> directory) when compiling your derived class, in addition to the header files (in the <code>src</code> directory). There is not a single header file for the library. Linking the solver classes require something like <code>-I&lt;path&gt;/libode/src -L&lt;path&gt;/libode/bin -lode</code> when when compiling derived code, with <code>&lt;path&gt;</code> replaced by path elements leading to the libode directory.</p>
<p>Test programs are compiled with <code>make tests</code> and they can all be run in sequence with the <code>run_all_tests.sh</code> script (which uses Python to plot the test results).</p>
<h1><a class="anchor" id="sec_usage"></a>
Using the Solvers</h1>
<p>To integrate a specific system of ODEs, a new class must be created to inherit from one of the solver classes. This new inheriting class must</p><ol type="1">
<li>Define the system of ODEs to be solved by implementing the <code>ode_fun</code> function. This is a virtual function in the base classes. Once it is implemented, it can be used by the stepping and solving functions.</li>
<li>Set initial conditions in the <code>sol</code> variable, which is an array with the same length as the system of ODEs.</li>
<li>Optionally implement the <code>ode_jac</code> function for implicit methods. This is also a virtual function in the base classes. If it's not overridden, a finite-difference estimate of the Jacobian is used.</li>
</ol>
<p>For flexibility, the derived class could be a template, so that the solver/method can be chosen when the class is constructed. Other than defining the system of equations and setting initial conditions, the derived class can store whatever information and implement whatever other methods are necessary. This could be something simple like an extra function for setting initial conditions. It could, however, comprise any other system that needs to run on top of an ODE solver, like the spatial discretization of a big PDE solver.</p>
<p>Each solver has a <code>step</code> method that can be used to integrate a single step with a specified step size. Each solver class also has a <code>solve_fixed</code> method and, if it's an adaptive class, a <code>solve_adaptive</code> method. These functions return nothing and both have the same four call signatures:</p>
<ol type="1">
<li><p class="startli"><code>void solve_fixed (double tint, double dt)</code></p>
<p class="startli">Simply advances the solution for a specified length of the independent variable. The independent variable is assumed to be time, so <code>tint</code> is the integration time and <code>dt</code> is the time step to use (or the initial time step for adaptive solves).</p>
</li>
<li><p class="startli"><code>void solve_fixed (double tint, double dt, const char *dirout, int inter)</code></p>
<p class="startli">Integrates for a duration of <code>tint</code> using time step (or initial time step) <code>dt</code> and writes solution values after every <code>inter</code> steps to the directory <code>dirout</code>. For example, if <code>inter</code> is one, the solution at every step is written to file. If <code>inter</code> is two, every other step is written.</p>
</li>
<li><p class="startli"><code>void solve_fixed (double tint, double dt, unsigned long nsnap, const char *dirout)</code></p>
<p class="startli">Integrates and writes <code>nsnap</code> even spaced snapshots of the solution into the directory <code>dirout</code>.</p>
</li>
<li><p class="startli"><code>void solve_fixed (double dt, double *tsnap, unsigned long nsnap, const char *dirout)</code></p>
<p class="startli">Integrates and writes snapshots at the times specified in <code>tsnap</code> into the directory <code>dirout</code>. </p>
</li>
</ol>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
